<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cutesy Finds | Admin</title>
    <!-- Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=Sora:wght@400;500;600;700;800&display=swap"
        rel="stylesheet">
    <!-- Icons -->
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="admin.css">
</head>

<body>

    <!-- BACKGROUND ANIMATION -->
    <div class="bg-wrapper">
        <div class="noise-overlay"></div>
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="orb orb-3"></div>
    </div>

    <!-- HEADER -->
    <header class="container">
        <div class="admin-header">
            <div class="brand">
                <span class="material-symbols-rounded">stars</span>
                CutesyFinds
                <span class="admin-tag">Admin</span>
            </div>
            <div class="header-actions">
                <a href="index.html" class="btn-header-secondary">
                    <span class="material-symbols-rounded" style="font-size:20px;">storefront</span>
                    <span class="btn-text">View Shop</span>
                </a>
                <button class="btn-header-secondary" onclick="logout()" style="color:#ef4444;">
                    <span class="material-symbols-rounded" style="font-size:20px;">logout</span>
                </button>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- STATS & SEARCH -->
        <div class="dashboard-controls">
            <div class="search-bar">
                <span class="material-symbols-rounded">search</span>
                <input id="searchInput" placeholder="Search products..." onkeyup="filterProducts()">
            </div>
            <div class="stat-pill">
                <span class="material-symbols-rounded" style="font-size:20px;">inventory_2</span>
                Total <span class="stat-count" id="totalProducts">0</span>
            </div>
            <div class="stat-pill success">
                <span class="material-symbols-rounded" style="font-size:20px; color:#34c759;">check_circle</span>
                <span class="btn-text">In Stock</span> <span class="stat-count" id="inStockCount">0</span>
            </div>
            <div class="stat-pill danger">
                <span class="material-symbols-rounded" style="font-size:20px; color:#ff3b30;">cancel</span>
                <span class="btn-text">Out</span> <span class="stat-count" id="outStockCount">0</span>
            </div>
        </div>

        <!-- PRODUCT GRID -->
        <div id="productList" class="product-grid">
            <!-- Cards rendered by JS -->
        </div>
    </div>

    <!-- FAB -->
    <button class="fab-add" onclick="addNewProduct()" aria-label="Add Product">
        <span class="material-symbols-rounded">add</span>
    </button>

    <!-- LOGIN MODAL -->
    <div class="modal" id="loginModal" style="background:linear-gradient(135deg, #fff5f7, #faf0ff); z-index:9000;">
        <div class="modal-content" style="max-width:380px; padding:40px; text-align:center;">
            <div class="login-icon"
                style="width:72px; height:72px; border-radius:22px; background:linear-gradient(135deg, #fff0f3, #ffe8f0); color:#ff477e; display:flex; align-items:center; justify-content:center; margin:0 auto 24px;">
                <span class="material-symbols-rounded" style="font-size:32px;">lock</span>
            </div>
            <h2 style="margin-bottom:8px;">Admin Access</h2>
            <p style="color:var(--text-gray); margin-bottom:24px; font-size:0.95rem;">Enter your password to continue
            </p>

            <p id="loginError"
                style="color:#ef4444; font-weight:bold; display:none; margin-bottom:16px; font-size:0.9rem;">
                Incorrect Password ❌</p>

            <form onsubmit="login(event)">
                <div class="form-group">
                    <input type="password" id="adminPassword" placeholder="Enter Password" required
                        style="text-align:center; padding:16px;">
                </div>
                <button type="submit" class="btn-save" style="width:100%; padding:16px; font-size:1rem;">
                    <span class="material-symbols-rounded" style="font-size:20px;">lock_open</span>
                    Unlock Dashboard
                </button>
            </form>
        </div>
    </div>

    <!-- EDIT MODAL -->
    <div class="modal" id="editModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-header-left">
                    <h2 id="modalTitle">Edit Product</h2>
                </div>
                <button class="btn-close" onclick="closeModal()">
                    <span class="material-symbols-rounded">close</span>
                </button>
            </div>

            <form id="productForm" onsubmit="saveProduct(event)">
                <input type="hidden" id="p_id">

                <div class="modal-body">
                    <!-- Basic Info -->
                    <div class="modal-section section-info">
                        <div class="modal-section-title">
                            <span class="material-symbols-rounded sec-icon">info</span>
                            Basic Info
                        </div>
                        <div class="form-group">
                            <label>Product Name</label>
                            <input id="p_name" required placeholder="e.g. Hello Kitty Bag">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Category</label>
                                <select id="p_cat" required>
                                    <option value="autres">Autres</option>
                                    <option value="hellokitty">Hello Kitty</option>
                                    <option value="accessoires">Accessoires</option>
                                    <option value="deco">Déco</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Badge</label>
                                <input id="p_badge" placeholder="e.g. New">
                            </div>
                        </div>

                    </div>

                    <!-- Pricing & Stock -->
                    <div class="modal-section section-pricing">
                        <div class="modal-section-title">
                            <span class="material-symbols-rounded sec-icon">payments</span>
                            Pricing & Stock
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Price (DH)</label>
                                <input id="p_price" type="number" required placeholder="0">
                            </div>
                            <div class="form-group">
                                <label>Old Price</label>
                                <input id="p_oldPrice" type="number" placeholder="Optional">
                            </div>
                        </div>
                        <div class="form-row" style="margin-top:4px;">
                            <div class="form-toggle-row" style="margin:0;">
                                <label class="toggle-label" for="p_inStock">
                                    In Stock
                                </label>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="p_inStock" onchange="toggleSimpleStockInput()">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            <div class="form-group" id="simpleStockContainer" style="margin:0;">
                                <label>Quantity</label>
                                <input type="number" id="p_simpleStock" placeholder="0">
                            </div>
                        </div>
                        <div class="form-group" style="margin-top:16px;">
                            <label>Sizes (comma separated)</label>
                            <input id="p_sizes" placeholder="S, M, L, XL" onblur="refreshVariantStockInputs()">
                        </div>
                    </div>

                    <!-- Media -->
                    <div class="modal-section section-media">
                        <div class="modal-section-title">
                            <span class="material-symbols-rounded sec-icon">image</span>
                            Media
                        </div>
                        <div class="form-group">
                            <label>Main Image URL</label>
                            <input id="p_img" required placeholder="https://...">
                        </div>
                        <div class="form-group">
                            <label>Gallery (comma separated URLs)</label>
                            <textarea id="p_images" rows="2" placeholder="url1.jpg, url2.jpg"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Description</label>
                            <textarea id="p_desc" rows="3" placeholder="Write a product description..."></textarea>
                        </div>
                    </div>

                    <!-- Variants -->
                    <div class="modal-section section-variants">
                        <div class="modal-section-title">
                            <span class="material-symbols-rounded sec-icon">category</span>
                            Variants
                            <button type="button" onclick="addVariantField()" class="btn-add-variant-inline">
                                <span class="material-symbols-rounded">add</span> Add
                            </button>
                        </div>
                        <div class="form-group" style="margin-bottom:16px;">
                            <label>Variant Style</label>
                            <select id="p_variantStyle">
                                <option value="color">Color Swatches</option>
                                <option value="button">Text Buttons</option>
                            </select>
                        </div>
                        <div id="variantsContainer"></div>
                    </div>
                </div>

                <!-- Modal Footer -->
                <div class="modal-footer">
                    <button type="button" class="btn-cancel" onclick="closeModal()">Cancel</button>
                    <button type="submit" class="btn-save">
                        <span class="material-symbols-rounded" style="font-size:18px;">check</span>
                        Save Product
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- SCRIPTS -->
    <script src="cities.js"></script>
    <script src="admin.js"></script>
</body>

</html>